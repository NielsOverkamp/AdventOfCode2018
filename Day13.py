inp = r"""                                                                                                   /--------------------\                             
                                 /-------------------------------------------\                     |                    |       /-------------------\ 
                                 |                   /----------\    /-------+---------------------+-\                  |       |                   | 
/--------------------------------+-------------------+----------+----+-------+-------\             | |                  |       |                   | 
|                                |                   |    /-----+----+-------+-------+-------------+-+------------------+-------+------------\      | 
|                          /-----+-------------------+----+-----+----+-------+-------+-------------+-+--\               |       |            |      | 
|          /---------------+-----+-------------------+----+-----+----+-------+-------+-------------+-+--+\              |       |            |      | 
|          |               |     |                   |    |     |    |       |  /----+-------------+-+--++--------------+-------+------------+-\    | 
|          |               |     |                   |    |     |    |       |  |    |             | |  ||              |       |            | |    | 
|          |               |     |              /----+----+-----+----+-------+--+----+----------<\ | |  ||              |       |            | |    | 
|      /---+---------------+-----+--------------+----+----+-----+----+-------+--+----+-----------+-+-+--++--\           |       |            | |    | 
| /----+---+---------------+-----+--------------+----+----+-----+--<-+-------+--+\   |       /---+-+-+--++--+-----------+-------+----\       | |    | 
| |    |   |               |     |              |    |    |     |    |       |  ||   |       |   | | |  ||  |           |       |    |       | |    | 
| |    |   |               |     |              |    |    |     |    |     /-+--++---+-----\ |   | | |  ||  |           |       |    |       | |    | 
| |    |   |               |     |              |    |    |     |    |     | |  ||   |     | |   | | |  ||  |           |/------+----+-------+-+---\| 
| |    |  /+---------------+-----+--------------+--\ |    |     |/---+-----+-+-\||   |     | |   | | |  ||  |           ||      |    |       | |   || 
| |  /-+--++---------------+-----+--------------+--+-+----+-----++---+-----+-+-+++---+---\ | |   | \-+--++--+-----------/|      |    |       | |   || 
| |  | |  ||     /---------+-----+-\      /-----+--+-+-\  |     ||   \-----+-+-+++---+---+-+-+---+---/  ||  |     /------+------+----+-------+\|   || 
| |  | |  ||     |         |     | |    /-+-----+--+-+-+--+-----++---------+-+-+++---+---+-+-+---+------++--+-----+------+-\    |    |       |||   || 
| |  | |  ||     |         |     | |    | |     |  | | |/-+-----++-------\ | | |||   |   | | |   |      ||  |     |      | |    |    |       |||   || 
| |  | |  ||     |         \-----+-+----+-+-----+--+-+-++-+-----++-------+-+-+-+++---+---+-+-+---+------/|  |     |      | |  /-+----+-----\ |||   || 
| |  | |  ||     |               | |    | |     |/-+-+-++-+-----++-------+-+-+-+++---+---+-+-+---+-----\ |  |/----+------+-+\ | |    |     | |||   || 
| |  | |  ||     |               | |    | |     || | | || |     ||       | | | |||   |   | | |   |     | |/-++----+------+-++-+-+----+-----+-+++--\|| 
| |  | |  ||     |               | |    | |     || | | || |     ||       | | | |||   |   | | |   |     | || ||    |      | || | |    |     | |||  ||| 
| |  | |  ||     |         /-----+-+----+\|     || | |/++-+----\||       | | | |||   |   | | |   |     | || ||    |      | || | |    |     | |||  ||| 
| |  | |/-++-----+---------+----\| |/---+++-----++-+-++++-+----+++-------+-+-+-+++---+---+-+-+---+-----+-++-++----+------+-++-+\|    |     | |||  ||| 
| |  | || ||     |         |    || ||   |||     || | |||| |    |||       | | | |||   |   | | \---+-----+-++-++----+------+-++-+++----/     | |||  ||| 
| |  | || ||     |         |    || ||   |||  /--++-+-++++-+----+++-------+-+-+\|||   |   | |     |     | || ||    |      | || |||          | |||  ||| 
| |  | || ||     |         |    || ||   |||  |  || | ||||/+----+++-------+-+-+++++---+---+-+-----+-----+-++-++----+------+-++-+++-\        | |||  ||| 
| |  | || ||     |         |    || ||   ||| /+--++-+-++++++----+++-------+-+-+++++---+---+-+-----+-----+-++-++----+------+-++-+++-+---\    | |||  ||| 
| |  | || ||     |         |    || ||   ||| ||  || | ||||||    |||       | | |||||   |   | |  /--+-----+-++-++----+------+-++-+++-+---+-\  | |||  ||| 
| |  | || ||     |         |    || ||   ||\-++--++-+-++/|||    |||       | | |||||  /+---+-+--+--+-----+-++-++----+------+-++-+++-+---+-+--+\|||  ||| 
| | /+-++-++-----+\        |    || ||   ||  ||  || | || |||    |||       | \-+++++--++---+-/  |  |     | || ||    |      | || ||| |   | |  |||||  ||| 
| | || || ||     ||        |    || ||   ||  ||  || | || |||    |||   /---+---+++++--++---+\   |  |     | || ||    |      | || ||| |   | |  |||||  ||| 
| | || || ||     ||        |    || ||   \+--++--++-+-++-+++----+++---+---+---+++++--++---++---+--+-----+-++-++----+------+-/| ||| |   | |  |||||  ||| 
| | || || ||     || /------+----++\||    |  ||  || | || |||    |||   |   |   |||||  ||   ||   |  |   /-+-++-++----+------+--+\||| |   | |  |||||  ||| 
| | || || || /---++-+------+----+++++----+--++--++-+-++-+++----+++---+---+---+++++--++---++---+--+---+-+-++-++---\|      |  ||||| |   | |  |||||  ||| 
| | || || || |   || |      \----+++++----/  ||  || | ||/+++----+++---+---+---+++++--++---++---+--+---+-+-++-++--\||      |  ||||| |   | |  |||||  ||| 
| | || || || |/--++-+-----------+++++-------++--++-+-++++++----+++---+---+---+++++--++---++---+--+-\ | | || ||  |||      |  ||||| |   | |  |||||  ||| 
| | || || || ||  || |           |||||/------++--++-+-++++++----+++---+---+---+++++--++---++---+--+-+-+-+-++-++--+++------+--+++++-+---+\|  |||||  ||| 
| | || || || ||  || |           ||||||  /---++--++-+-++++++----+++---+---+---+++++--++---++---+--+-+-+-+-++-++\ |||      |  ||||| |   |||  |||||  ||| 
| | ||/++-++-++--++-+-\         ||||||/-+---++--++-+-++++++----+++---+---+---+++++--++---++---+--+-+-+-+-++-+++-+++------+--+++++\|   |||  |||||  ||| 
| | ||||| || ||  || |/+---------+++++++-+-\ ||  || | ||||||  /-+++---+---+---+++++--++---++---+--+-+-+-+-++-+++-+++\     |  |||||||   |||  |||||  ||| 
| | |\+++-++-++--++-+++---------+++++++-+-+-++--++-+-++++++--+-+++---+---+---+++++--++---/|   |  | | | | || ||| ||||     |  |||||||   |||  |||||  ||| 
| | | ||| || ||  || |||         ||||||| | | ||  \+-+-++++++--+-+++---+---+---+++++--++----+---+--/ | | | || |\+-++++-----+--/||||||   |||  |||||  ||| 
| | | ||| || || /++-+++---------+++++++-+-+-++---+-+-++++++--+-+++---+---+---+++++--++----+---+--\ | | | || | | ||||     |   |||\++---+++--+++++--++/ 
| | | ||| \+-++-+++-+++---------+++++++-+-+-++---+-/ ||\+++--+-+++---+---+---+++++--++----+>--+--+-+-+-+-++-+-+-/|||     |   ||| ||   |||  |||||  ||  
| | | |||  | \+-+++-+++---------+++++++-+-+-++---+---++-+++--+-+++---+---+---+++++--++----+---+--+-+-+-+-++-+-+--/||     |   ||| ||   |||  |||||  ||  
| | | |||  |  | ||| |||         ||||||| | | ||   |   || |||  | |||   |   |   |||||  ||    |/--+--+-+-+-+-++-+-+---++-----+---+++-++---+++--+++++--++-\
| | | |||  |  | ||| |||         ||||||| | | ||   |   || |||  | |||   |   |/--+++++--++----++--+--+-+-+-+-++-+-+---++-----+---+++-++---+++-\|||||  || |
| | | |||  |  | ||| |||         ||||||| | | ||   |   || |||  | |||   | /-++--+++++--++----++--+--+-+-+-+-++-+-+---++---\ |   ||| ||   ||| ||||||  || |
| | | |||  |  | ||| |||         ||||||| | | ||   |  /++-+++--+-+++---+-+-++--+++++--++---\||  |  | |/+-+-++-+-+---++---+-+---+++-++---+++-++++++--++\|
| | | |||  |  | ||| |||         ||||||| | | ||   |  ||| |||  | |||   | | ||  |||||  ||   |||  |  | ||| | || | |   ||   | |   ||| ||   ||| ||||||  ||||
| | | |||  |  | ||| |||         ||||||| | | ||   |  ||| |||  | |||   | | ||  |||||  ||  /+++--+--+-+++-+-++-+-+---++---+-+---+++-++---+++\||||||  ||||
| | | \++--+--+-+++-++/         ||||||| | | ||/--+--+++-+++--+-+++---+-+-++--+++++--++--++++--+--+-+++-+-++-+-+---++---+-+---+++-++\  ||||||||||  ||||
| | |  ||  |  | ||| ||          ||||||| | | |||  |  |\+-+++--+-+/|   | | ||  |||||  ||  ||||/-+--+-+++-+-++-+-+---++---+\|   ||| |||  ||||||||||  ||||
| | |  ||  |  | \++-++----------+++++++-+-+-+++--+--+-+-+++--+-+-+---+-+-++--+++++--++--+++++-+--/ ||| | || | |   ||   |||   ||| |||  ||||||||||  ||||
| | |  ||  |  |  ||/++----------+++++++-+-+-+++--+--+-+-+++--+-+-+---+-+-++--+++++--++-\||||| |    ||| | || | |   ||/--+++---+++-+++--++++++++++-\||||
| | |  ||  |  |  |||||  /-------+++++++-+-+-+++--+--+-+-+++--+-+-+---+-+\||  |||||  || |||||| |    ||| | || | |   |||  |||   ||| |||  |||||||||| |||||
| | |  ||  |  |  |||||  |       ||||||| | | |||  |  | | |||  | | |   | ||||  |||||  || |||||| |    ||| | || | |/--+++--+++-\ ||| |||  |||||||||| |||||
| |/+--++--+--+--+++++--+---\   |||||||/+-+-+++--+--+-+-+++-\^ | |   | ||||  |||||  || |||||| |    ||| | || | ||  |||  ||| | ||| |||  |||||||||| |||||
| |||  ||  |/-+--+++++--+---+---+++++++++-+-+++--+--+-+-+++-++-+-+---+-++++--+++++--++-++++++-+----+++-+-++-+-++--+++\ ||| | ||| |||  |||||||||| |||||
| ||\--++--++-+--+/|||  |   | /-+++++++++-+-+++--+--+\|/+++-++-+-+---+-++++--+++++--++-++++++-+----+++-+-++-+-++--++++-+++-+-+++-+++--++++++++++\|||||
| ||   ||  \+-+--+-+++--+---+-+-+++++++++-+-+++--+--+++++++-++-+-+---+-++++--+++++--++-++++++-+----+++-+-/| | ||  |||| ||| | ||| |||  ||||||||||||||||
| ||   ||   | |  | |||  |   | | |||||||||/+-+++--+\ ||||||| || | |   | |||\--+++++--++-++++++-+----+++-+--+-+-++--++++-+++-+-+++-+++--++++/|||||||||||
| ||   ||   | |  | |||  |   | | ||||||||||| |||  || ||||||| || | |   |/+++---+++++--++-++++++-+----+++-+--+-+\||  |||| ||| | ||| |||  |||| |||||||||||
| ||/--++---+-+--+-+++--+--\| | ||||||||||| |||  || ||||||| || | |   \++++---+++++--++-+++/|| |    ||| |  | ||||  |||| ||| | ||| |||  |||| |||||||||||
| |||  ||   | |  | |||  | /++-+-+++++++++++-+++--++-+++++++-++-+-+----++++---+++++--++-+++-++-+----+++-+\ | ||||  |||| ||| | ||| |||  |||| |||||||||||
| |||  ||   | |  | |||  | ||| | ||||||||||| |||  || ||||||| || | |    ||||   |||||  || ||| || |/---+++-++-+-++++--++++-+++-+-+++-+++\ |||| |||||||||||
| ||v  ||   | |  | |||  | ||| |/+++++++++++-+++--++-+++++++-++-+-+----++++---+++++--++-+++-++-++---+++-++-+-++++\ |||| ||| | ||| |||| |||| |||||||||||
| |||/-++---+>+--+-+++--+-+++-+++++++++++++-+++--++-+++++++-++-+-+----++++---+++++--++-+++-++-++\  ||| || | ||||| |||| ||| | ||| |||| |||| |||||||||||
| |||| ||   | |  | |||  | ||| ||||||||||||| |v|  || ||||||| || | | /--++++---+++++--++-+++-++-+++--+++-++-+\||||| |v|| ||| | ||| |||| |||| |||||||||||
| |||| ||   | |  | |||  | ||| ||||||||||||| |||  || ||||||| || | | |  ||||   |||||  || ||| || |||  ||| || ||||||| |||| ||| | ||| |||| |||| |||||||||||
| |||| ||   | |  | ||\--+-+++-++++++++++++/ |||  || ||||||| || | | |  ||||   |||||  || ||| || |||  ||| || ||||||| |||| ||| | ||| |||| |||| |||||||||||
| |||| ||   | |  | ||   | ||| ||||||||||||  |||  || ||||||| || | | |  ||||   |||||  || ||| || |||  ||| || ||||||| |||| ||| | ||| |||| |||| |||||||||||
| |||| ||   | |  | |\---+-+++-++++/|||||||  |||  || ||||||| || | | |  ||||   |||||  || ||| || |||  ||| || ||||||| |||| ||| | ||| |||| |||| |||||||||||
| |||| || /-+-+--+-+----+-+++\|||| |||||||  |||  || ||||||\-++-+-+-+--++++---+++++--++-+++-++-+++--+++-++-+++++++-++++-+++-+-+++-++++-++++-++/||||||||
| |||| || | | |  | |    | |||||||\-+++++++--+++--++-++++++--++-+-+-+--++++---/||||  || ||| || |||  ||| || ||||||| |||| ||| | ||| |||| |||| || ||||||||
| |||| || | | |  | | /--+-+++++++\ |||||||  |||  || ||||||  || | | |  ||||    ||||  || ||| || |||  ||| || ||||||| |||| ||| | ||| |||| |||| || ||||||||
| |||| || | | |  | | |  | |||||||| |||||||  ||\--++-++++++--++-+-+-+--++++----++++--++-+++-++-+++--+++-++-+++++++-++++-+++-+-+++-++/| |||| || ||||||||
\-++++-++-+-+-+--+-+-+--+-++++++++-+++++++--++---++-++++++--++-+-+-+--++++----++++--+/ ||| || |||  ||| || \++++++-++++-+++-+-+++-++-+-++++-++-++++/|||
  |||| || | | |  | | |  | |||||||| |\+++++--++---++-++++++--++-+-+-+--++++----++++--+--+++-++-+++--+++-++--++++++-++++-+++-+-++/ || | |||| || |||| |||
  |||| \+-+-+-+--+-+-+--+-++++++++-+-+++++--++---++-++++++--++-+-+-+--++++----++++--+--+++-++-+++--+++-++--+/|||| |||| ||| | ||  || | |||| || |||| |||
  ||||  | | | |  | | |  | \+++++++-+-+++++--++---++-++++++--++-+-+-+--++++----++++--+--+++-++-+++--+++-+/  | |||| |||| ||| | ||  || | |||| || |||| |||
  ||||  | | | |  | | |  |  ||||||| | |||||  ||   ||/++++++--++-+-+-+--++++----++++--+--+++\|| |||  ||\-+---+-++++-++++-+++-+-/|  || | |||| || |||| |||
  ||||  | | | |  | |/+--+--+++++++-+\|||||  ||   |||||||||  || | | |  |||| /--++++--+--++++++-+++--++--+-\ | |||| |||| ||\-+--+--++-+-++++-++-++++-/||
  ||\+--+-+-+-+--+-+++--+--/|||||| |||||||  ||   |||||||||  || | | |  |||| |  ||||  \--++++++-+++--++--+-+-+-++++-++++-++--+--+--++-+-++++-+/ ||||  ||
  || |  | | | |  | |||  |   |||||| |||||||  ||   |||||||||  || | | |  |||| |  ||||     |||||| \++--++--+-+-+-++++-++++-++--+--+--++-+-++/| |  ||||  ||
  || |  | | | |  | |||  |   |||||| |||||||  ||   ||||||\++--++-+-+-+--++++-+--++++-----++++++--++--++--+-+-+-++++-++++-++--+--+--++-+-++-+-+--++/|  ||
  || |  | | | |  | |||  | /-++++++-+++++++--++---++++++-++--++-+-+-+--++++-+--++++-----++++++--++--++--+-+-+-++++-++++-++--+--+--++-+\|| | |  || |  ||
  || |  | | | |  | |||  | | |||||| |||||||  ||   |||||| ||  || | | |  |||| |  ||||  /--++++++--++--++--+-+-+-++++-++++-++-\|  |  || |||| | |  || |  ||
  || |  | | | |  | |||  | | |||||| ||||||\--++---+/|^|| ||  || | | |  |||| |  ||||  |  ||||||  ||  ||  | | | |||| |||| || ||  |  || |||| | |  || |  ||
  ||/+--+-+-+-+--+-+++--+\| |||||| ||||||   ||   | |||| ||  ||/+-+-+--++++-+--++++\ |  ||||||  ||  ||  | | | |||| |||| || ||  |  || |||| | |  || |  ||
  ||||  | | | |  | |||  ||| |||||| ||||||   || /-+-++++-++--++++-+-+--++++-+--+++++-+--++++++--++--++--+-+-+-++++-++++-++-++--+--++\|||| | |  || |  ||
  \+++--+-+-+-+--+-+++--+++-++++++-++++++---++-+-+-++++-++--++++-+-+--++++-+--+++/| |  ||||||  ||  ||  | | | |||| |||| || ||  |  ||||||| | |  || |  ||
   |||  | | | |/-+-+++--+++-++++++-++++++---++-+-+-++++-++--++++-+-+--++++-+--+++-+-+--++++++--++--++-\| | | |||| |||| || ||  |  ||||||| | |  || |  ||
   |||/-+-+-+-++-+-+++--+++\|||||| ||||||   || | | |||| ||  |||| | |  |||| |  ||| | |  ||||||  ||  || || | | |||| |||| || ||  |  ||||||| | |  || |  ||
   |||| | | | || | |||  |||||||||| ||||||   || | | |||| ||  |||| | |  |||| |  ||\-+-+--++++++--++--++-++-+-+-++++-++++-++-++--+--+++++++-+-+--+/ |  ||
   |||| |/+-+-++-+-+++--++++++++++-++++++---++-+-+-++++-++--++++-+-+--++++-+--++--+-+->++++++--++--++-++\| | |||| |||| || ||  |  ||||||| | |  |  |  ||
   |||| ||| | || | |||  |||||||||| ||||||   || | | |||| ||  |||| | |  |||| |  ||  | | /++++++--++--++-++++-+-++++-++++-++-++--+--+++++++-+-+--+--+\ ||
   |||| ||| | || | |||  |||||||\++-++++++---++-+-+-++++-++--++++-+-+--++++-+--++--+-+-+++++++--++--++-++++-+-+++/ |||| || ||  |  ||||||| | |  |  || ||
   |\++-+++-+-++-+-+++--+/||||| || ||||||   || | | \+++-++--++++-+-+--++++-+--++--+-+-++++/||  ||  || |||| | |||  |||| || ||  |  ||||||| | |  |  || ||
   | || ||| | || | |||  | ||||| || ||||||   || | |  ||| ||  |||| | |  \+++-+--++--+-+-++++-++--++--++-++++-+-/||  |||| || ||  |  ||||||| | |  |  || ||
   | || ||| | || | ||\--+-+++++-+/ ||||||   || | |  ||| |\--++++-+-+---+++-+--++--+-+-++++-++--++--++-++++-+--++--++++-++-++--+--+/||||| | |  |  || ||
   | \+-+++-+-++-+-++---+-+++++-+--++++++---++-+-+--+++-+---++++-+-+---+++-+>-++--+-+-++++-++--+/  || |||| |  ||  |||| || ||  |  | ||||| | |  |  || ||
   |  | ||| | || \-++---+-+++++-+--/|||||   || | |  ||| |   |||| | \---+++-+--++--+-+-++++-++--+---++-++++-/  ||  |||| || ||  |  | ||||| | |  |  || ||
   |  | ||| | ||   ||   | ||||| |   |||||   || | |  \++-+---++++-+-----+++-+--++--+-+-+++/ ||  |   || ||||    ||  \+++-++-++--+--+-+++++-+-+--/  || ||
   |  | ||| | ||  /++---+-+++++-+---+++++---++\| | /-++-+---++++-+-----+++-+--++--+-+-+++--++--+---++-++++----++---+++-++-++--+--+-+++++-+-+-----++\||
   |  |/+++-+-++--+++---+-+++++-+---+++++--\\+++-+-+-++-+---++++-+-----+++-+--++--+-+-+++--++--+---++-++++----++---+++-++-++--+--+-+++/| | |     |||||
   |  ||\++-+-++--+++---+-+++++-/   |||||  | ||| | | || |   |||| |     ||| |  ||  | | |||  ||  |   || ||||    ||   |||/++-++--+--+-+++-+-+-+---\ |||||
   |  || || | ||  |||   | |||||     ||||\--+-+++-+-+-++-+---++++-+-----+++-+--++--+-+-+++--++--+---++-++++----/|   ||||||/++--+--+-+++-+-+-+-\ | |||||
   |  || || | ||  |||   | |||||     ||||   | ||| | | v| |   |||| |     ||| |  ||  | | |||  ||  |   |\-++++-----+---+++++++++--+--+-+++-+-+-+-+-+-+++/|
   |  || || |/++--+++---+-+++++-----++++---+-+++-+-+-++-+--\|||| |   /-+++-+--++--+-+-+++--++--+---+--++++--\  |   |||||||||  |  | ||| | | | | | ||| |
   |  || || ||||  |||   | |||||     ||||   | ||| | | || |  ||||| \---+-+++-+--+/  | | |||  ||  |   |  ||||  |  |   |||||||||  |  | ||| | | | | | ||| |
   |  || || ||||  |||   | |||||     ||||   | ||| | | || |  |||||   /-+-+++-+--+---+-+-+++--++--+---+--++++\ |  |   |||||||||  |  | ||| | | | | | ||| |
   |  || || ||||  |||   \-+++++-----++++---+-+++-+-+-++-+--+++++---+-+-+/| |  |   | \-+++--++--+---+--+++++-+--+---+++++++/|  |  | ||| | | | | | ||| |
   |  || || ||||  |||     \++++-----++++---+-+++-+-+-++-+--+++++---+-+-+-+-+--+---+---+++--++--+---+--+++++-+--+---+++++++-+--+--+-++/ | | | | | ||| |
   |  || || ||||  |||      ||||     ||||   | ||| | \-++-+--+++++---+-+-+-+-+--+---+---+++--++--+---+--+++++-+--+---+++++++-+--+--+-++--+-+-+-+-+-++/ |
   |  || || ||||  |\+------++++-----++++---+-+++-+---++-+--+++++---+-+-+-+-+--+---+---+/|  ||  |   |  ||||| |  |   ||||||| |  |  | ||  | | | | | ||  |
   |  || || ||||  | |      ||||     ||||   | ||| |   || |  |||||   | | | | |  |   |   | |  ||  \---+--+++++-+--+---+++++++-+--+--+-+/  | | | | | ||  |
   |  || \+-++++--+-+------++++-----++++---+-+++-+---++-+--+++++---+-+-+-+-+--+---+---+-+--++------+--++/|| |  |   |\+++++-+--+--+-+---+-+-+-+-+-/|  |
   \--++--+-++++--+-+------+/||     ||||   | ||| |   || |  |||||   | | | | |  |   |   | |  ||      |  || || |  |   | ||||| |  |  | |   | | | | |  |  |
      ||  | ||||  | |      | ||     ||||   | ||| \---++-+--+++++---+-+-+-+-+--+---+---+-+--++------+--+/ || |  |   | |\+++-+--+--+-+---+-+-+-+-/  |  |
      ||  | ||||  | |      | |\>----++++---+-+++-----/| |  |||||   | | | | |  |   |   | |  ||      |  |  || |  |   | | ||| |  \--+-+---+-+-/ |    |  |
      ||  | ||||  | |      | |      ||||   | |||      \-+--++++/   |/+-+-+-+--+---+---+-+--++---\  |  |  || |  |   | | ||| |     | |   | |   |    |  |
      ||  | ||||  | |      | |      ||||   | |||        \--++++----+++-+-/ |  |   |   | |  ||   |  |  |  || |  |   | | ||| |     | |   | |   |    |  |
      |\--+-++++--+-+------+-+------++++---/ |||           ||||    ||| |   |  |   |   | \--++---+--+--+--++-+--+---+-+-+++-+-----+-+---+-/   |    |  |
      |   | ||||  | |      | |      ||||     |||           ||||    ^|| |   |  |   |   |    ||   |  |  |  || |  |   | | ||| |     | |   |     |    |  |
      |   \>++++--+-+------+-/      ||||  /--+++-----------++++----+++-+--\|  |   |   |    ||   |  |  |  || |  |   | | ||| |     | |   |     |    |  |
      |     ||||  | |      |        ||||  |  |||           ||||    ||| |  |\--+---+---+----++---+--+--+--/| |  |   | | ||| |     | |   |     |    |  |
      |     ||||  | |      |        ||||  |  \++-----------++++----+++-+--+---/   |   |    ||   |  |  |   | |  |   | | ||| |     | |   |     |    |  |
      |     |||\--+-+------+--------++++--+---++-----------++++----+++-+--+-------+---+----++---+--+--/   | |  |   | | ||| |     | |   |     |    |  |
      |     |||   | |      |        ||||  |   ||           ||||    ||| |  |       |   \----++---+--+------+-+--+---+-+-+++-+-----+-+---+-----+----/  |
      \-----+++---+-+------/        |\++--+---++-----------++++----+++-+--+-------+--------++---+--+------+-+--+---+-+-+++-+-----+-+---/     |       |
            |||   | |               | ||  |   ||           ||||    |\+-+--+-------+--------++---/  |      | |  |   | | ||| |     | |         |       |
            |||   | |               | ||  |   |\-----------++++----+-+-+--+-------+--------++------+------+-+--+->-+-+-+++-+-----+-/         |       |
            |||   | |               | ||  |   |            ||||    | | |  |       |        |\------+------+-+--+---+-+-+/| |     |           |       |
 /----------+++---+-+-\             | ||  |   |            ||||    | \-+--+-------+--------+-------+------+-/  |   | | | | |     |           |       |
 |          ||\---+-+-+-------------+-++--+---+------------++++----+---+--+-------+--------+--->---/      |    |   | | | \-+-----+-----------/       |
 |          ||    | | |             | ||  |   |            ||||    |   |  |       |        \--------------+----+---+-+-+---+-----+-------------------/
 |          ||    | \-+-------------/ ||  |   |            ||||    |   |  |       |                       |    |   | | |   |     |                    
 |          ||    \---+---------------++--+---/            ||||    |   |  |       |                       |    |   | | |   |     |                    
 |          |\--------+---------------++--+----------------/|||    |   \--+-------+-----------------------+----+---+-+-/   |     |                    
 |          |         |               ||  |                 |||    |      |       |                       |    \---+-+-----/     |                    
 |          |         |               ||  \-----------------+++----+------/       |                       |        | |           |                    
 |          |         |               ||                    |||    \--------------+-----------------------/        | |           |                    
 |          |         |               ||                    |\+-------------------+--------------------------------/ |           |                    
 |          |         |               \+--------------------+-+-------------------+----------------------------------+-----------/                    
 \----------+---------/                \--------------------/ \-------------------/                                  |                                
            \--------------------------------------------------------------------------------------------------------/                                
"""

# inp = r"""/->-\
# |   |  /----\
# | /-+--+-\  |
# | | |  | v  |
# \-+-/  \-+--/
#   \------/  """

# inp = r"""/>-<\
# |   |
# | /<+-\
# | | | v
# \>+</ |
#   |   ^
#   \<->/"""


class Track:
    def __init__(self, north=None, east=None, south=None, west=None, has_cart=False):
        self.north = north
        self.east = east
        self.south = south
        self.west = west
        self.has_cart = has_cart
        self.next = next

    def has_north(self):
        return self.north is not None

    def has_east(self):
        return self.east is not None

    def has_south(self):
        return self.south is not None

    def has_west(self):
        return self.west is not None


class Junction(Track):
    def __init__(self, north, east, south, west):
        super().__init__(north, east, south, west, has_cart=False)

    def left(self, dir):
        dx, dy = dir
        if dx == 1:
            return self.north, (0, -1)
        elif dy == 1:
            return self.east, (1, 0)
        elif dx == -1:
            return self.south, (0, 1)
        elif dy == -1:
            return self.west, (-1, 0)

    def right(self, dir):
        dx, dy = dir
        if dx == 1:
            return self.south, (0, 1)
        elif dy == 1:
            return self.west, (-1, 0)
        elif dx == -1:
            return self.north, (0, -1)
        elif dy == -1:
            return self.east, (1, 0)

    def straight(self, dir):
        dx, dy = dir
        if dx == 1:
            return self.east, (1, 0)
        elif dy == 1:
            return self.south, (0, 1)
        elif dx == -1:
            return self.west, (-1, 0)
        elif dy == -1:
            return self.north, (0, -1)


class DefaultTrack(Track):
    def __init__(self, north=None, east=None, south=None, west=None, has_cart=False):
        super().__init__(north, east, south, west, has_cart)
        self.track1 = None
        self.from_dir1 = None
        self.to_dir1 = None
        self.track2 = None
        self.from_dir2 = None
        self.to_dir2 = None

    def finalize(self):
        if self.north is not None:
            if self.track1 is None:
                self.track1, self.from_dir1, self.to_dir1 = self.north, (0, 1), (0, -1)
            else:
                self.track2, self.from_dir2, self.to_dir2 = self.north, (0, 1), (0, -1)
        if self.east is not None:
            if self.track1 is None:
                self.track1, self.from_dir1, self.to_dir1 = self.east, (-1, 0), (1, 0)
            else:
                self.track2, self.from_dir2, self.to_dir2 = self.east, (-1, 0), (1, 0)
        if self.west is not None:
            if self.track1 is None:
                self.track1, self.from_dir1, self.to_dir1 = self.west, (1, 0), (-1, 0)
            else:
                self.track2, self.from_dir2, self.to_dir2 = self.west, (1, 0), (-1, 0)
        if self.south is not None:
            if self.track1 is None:
                self.track1, self.from_dir1, self.to_dir1 = self.south, (0, -1), (0, 1)
            else:
                self.track2, self.from_dir2, self.to_dir2 = self.south, (0, -1), (0, 1)


    def nxt(self, dir):
        if self.from_dir1 == dir:
            return self.track2, self.to_dir2
        else:
            return self.track1, self.to_dir1


def prv(c, d):
    x, y = c
    dx, dy = d
    return x - dx, y - dy


def nxt(c, d):
    x, y = c
    dx, dy = d
    return x - dx, y - dy


def north(c):
    x, y = c
    return x, y - 1


def east(c):
    x, y = c
    return x + 1, y


def south(c):
    x, y = c
    return x, y + 1


def west(c):
    x, y = c
    return x - 1, y


def right(d):
    dx, dy = d
    if dx == 1:
        dx = 0
        dy = 1
    elif dy == 1:
        dx = -1
        dy = 0
    elif dx == -1:
        dx = 0
        dy = -1
    else:
        dx = 1
        dy = 0
    return dx, dy


def left(d):
    dx, dy = d
    if dx == 1:
        dx = 0
        dy = -1
    elif dy == -1:
        dx = -1
        dy = 0
    elif dx == -1:
        dx = 0
        dy = 1
    else:
        dx = 1
        dy = 0
    return dx, dy


def print_board(b, mx, my):
    for y in range(my):
        s = []
        for x in range(mx):
            if (x,y) in b:
                track = b[(x,y)]
                if track.has_cart:
                    s.append("C")
                elif isinstance(track, DefaultTrack):
                    s.append("Â·")
                else:
                    s.append("+")
            else:
                s.append(" ")
        print(''.join(s))


c = (0, 0)
d = (1, 0)

tracks = dict()
carts = []

for track_char in inp:
    if c == (95, 9):
        print()
    if track_char == "-" or track_char == ">" or track_char == "<":
        west_track = tracks[west(c)]
        tracks[c] = DefaultTrack(west=west_track, east=False)
        west_track.east = tracks[c]
    elif track_char == "|" or track_char == "v" or track_char == "^":
        north_track = tracks[north(c)]
        tracks[c] = DefaultTrack(north=north_track, south=False)
        north_track.south = tracks[c]
    elif track_char == "/":
        west_c = west(c)
        if (west_c in tracks) and (tracks[west_c].has_east()):
            west_track = tracks[west_c]
            north_track = tracks[north(c)]
            tracks[c] = DefaultTrack(west=west_track, north=north_track)
            west_track.east = tracks[c]
            north_track.south = tracks[c]
        else:
            tracks[c] = DefaultTrack(east=False, south=False)
    elif track_char == '\\':
        west_c = west(c)
        if (west_c in tracks) and (tracks[west_c].has_east()):
            west_track = tracks[west_c]
            tracks[c] = DefaultTrack(west=west_track, south=False)
            west_track.east = tracks[c]
        else:
            north_track = tracks[north(c)]
            tracks[c] = DefaultTrack(east=False, north=north_track)
            north_track.south = tracks[c]
    elif track_char == "+":
        west_track = tracks[west(c)]
        north_track = tracks[north(c)]
        tracks[c] = Junction(west=west_track, north=north_track, east=False, south=False)
        west_track.east = tracks[c]
        north_track.south = tracks[c]

    if track_char == ">":
        carts.append((c, (1, 0), tracks[c], "right"))
        tracks[c].has_cart = True
    elif track_char == "v":
        carts.append((c, (0, 1), tracks[c], "right"))
        tracks[c].has_cart = True
    elif track_char == "<":
        carts.append((c, (-1, 0), tracks[c], "right"))
        tracks[c].has_cart = True
    elif track_char == "^":
        carts.append((c, (0, -1), tracks[c], "right"))
        tracks[c].has_cart = True

    x, y = c
    if track_char == "\n":
        c = 0, y + 1
    else:
        c = x + 1, y

for track in tracks.values():
    if isinstance(track, DefaultTrack):
        track.finalize()

dirs = {(0, 1): "east", (0, -1): "west", (-1, 0): "north", (1, 0): "south"}

tick = 0

mx = 7
my = 7
crashed = set()
while True:
    # print_board(tracks, mx, my)
    carts = list(filter(lambda x: x[0] not in crashed, sorted(carts, key=lambda cart: (cart[0][1], cart[0][0]))))
    if len(carts) <= 1:
        print(carts[0])
        break
    new_carts = []
    crashed = set()
    for coord, dir, track, prev_turn in carts:
        if coord not in crashed:
            track.has_cart = False
            if isinstance(track, DefaultTrack):
                track, dir = track.nxt(dir)
            elif isinstance(track, Junction):
                if prev_turn == "left":
                    track, dir = track.straight(dir)
                    prev_turn = "straight"
                elif prev_turn == "straight":
                    track, dir = track.right(dir)
                    prev_turn = "right"
                elif prev_turn == "right":
                    track, dir = track.left(dir)
                    prev_turn = "left"
            x, y = coord
            dx, dy = dir
            coord = (x + dx, y + dy)
            if track.has_cart:
                print("Crash at ", coord)
                track.has_cart = False
                crashed.add(coord)
            else:
                track.has_cart = True
                new_carts.append((coord, dir, track, prev_turn))
    carts = new_carts
    tick += 1
